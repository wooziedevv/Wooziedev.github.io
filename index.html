<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wooziedev Panel</title>
<style>
body { background:#0f0f0f; color:#fff; font-family:'Segoe UI', sans-serif; margin:0; padding:0; }
header { padding:1rem; background:#111; display:flex; justify-content:space-between; align-items:center; }
a { color:#fff; text-decoration:none; margin-left:1rem; }
main { padding:2rem; max-width:1200px; margin:auto; }
input, button, textarea { padding:0.6rem; margin:0.3rem 0; border-radius:5px; border:none; outline:none; }
input, textarea { width:100%; }
button { cursor:pointer; background:#fff; color:#000; font-weight:600; }
button:hover { background:#ccc; }
section { margin-bottom:2rem; }
#dashboardContainer, #profileSection { display:none; }
#alertEmailVerify { display:none; color:#ff0; margin-bottom:1rem; }
</style>
</head>
<body>

<header>
<h1>Wooziedev</h1>
<nav>
<a href="#dashboardContainer">Dashboard</a>
<a href="#profileSection">Profil</a>
</nav>
</header>

<main>

<section id="auth">
<h2>Kayıt / Giriş</h2>

<div id="registerBox">
<h3>Kayıt Ol</h3>
<input type="text" id="regUsername" placeholder="Kullanıcı Adı">
<input type="email" id="regEmail" placeholder="E-mail">
<input type="password" id="regPassword" placeholder="Şifre">
<button onclick="register()">Kayıt Ol</button>
</div>

<div id="loginBox">
<h3>Giriş Yap</h3>
<input type="email" id="loginEmail" placeholder="E-mail">
<input type="password" id="loginPassword" placeholder="Şifre">
<button onclick="login()">Giriş</button>
<button onclick="resetPassword()">Şifremi Unuttum</button>
</div>

<div id="alertEmailVerify">Lütfen e-posta adresinizi doğrulayın. Mail kutunuzu kontrol edin.</div>
</section>

<section id="dashboardContainer">
<h2>Dashboard</h2>
<p>Burada rank kasımı, eventler ve sohbet alanları olacak.</p>
</section>

<section id="profileSection">
<h2>Profilim</h2>
<p>Kullanıcı Adınız: <span id="displayUsername"></span></p>
<textarea id="aboutMe" rows="4" placeholder="Hakkınızda yazısı"></textarea>
<button onclick="saveProfile()">Profili Kaydet</button>
<button onclick="logout()">Çıkış Yap</button>
</section>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, sendPasswordResetEmail, sendEmailVerification, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyBRWCBCSNCLv2Mgz-8OAxTE_hHTcDPW9tE",
authDomain: "wooziedevsite.firebaseapp.com",
projectId: "wooziedevsite",
storageBucket: "wooziedevsite.appspot.com",
messagingSenderId: "181692137747",
appId: "1:181692137747:web:f773cfb5d4db225e70dae6"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Argo ve eşsiz kullanıcı adı kontrolü
const bannedWords = ["argo1","argo2","argo3"];

window.register = async ()=>{
const username = document.getElementById("regUsername").value.trim();
const email = document.getElementById("regEmail").value;
const password = document.getElementById("regPassword").value;
if(!username||!email||!password) return alert("Tüm alanları doldurun.");
if(bannedWords.some(w=>username.toLowerCase().includes(w))) return alert("Kullanıcı adı uygun değil.");

const usersRef = collection(db,"users");
const snapshot = await getDocs(usersRef);
if(snapshot.docs.some(d=>d.data().username===username)) return alert("Bu kullanıcı adı alınmış.");

try {
  const userCred = await createUserWithEmailAndPassword(auth,email,password);
  const user = userCred.user;

  // E-posta doğrulama maili gönder
  const actionCodeSettings = {
    url: 'https://seninsite.com/login', // Buraya kendi site URL'ini koy
    handleCodeInApp: true
  };
  await sendEmailVerification(user, actionCodeSettings);

  await setDoc(doc(db,"users",user.uid),{email, username, createdAt:new Date().toISOString(), about:""});
  alert("Kayıt başarılı! Lütfen e-posta adresinizi doğrulayın.");
} catch(e){
  if(e.code === 'auth/email-already-in-use') alert("Bu e-posta zaten kayıtlı.");
  else alert(e.message);
}
};

window.login = async ()=>{
const email = document.getElementById("loginEmail").value;
const password = document.getElementById("loginPassword").value;
try{
const userCred = await signInWithEmailAndPassword(auth,email,password);
const user = userCred.user;
if(!user.emailVerified){
  document.getElementById("alertEmailVerify").style.display="block";
  return;
}
}catch(e){ alert(e.message); }
};

window.logout = ()=>signOut(auth);

window.resetPassword = ()=>{
const email = document.getElementById("loginEmail").value;
if(!email) return alert("Email giriniz.");
sendPasswordResetEmail(auth,email).then(()=>alert("Şifre sıfırlama maili gönderildi!")).catch(e=>alert(e.message));
};

onAuthStateChanged(auth,user=>{
if(user){
document.getElementById("registerBox").style.display="none";
document.getElementById("loginBox").style.display="none";
if(user.emailVerified){
  document.getElementById("dashboardContainer").style.display="block";
  document.getElementById("profileSection").style.display="block";
  document.getElementById("alertEmailVerify").style.display="none";
}else{
  document.getElementById("dashboardContainer").style.display="none";
  document.getElementById("profileSection").style.display="none";
  document.getElementById("alertEmailVerify").style.display="block";
}
}else{
document.getElementById("registerBox").style.display="block";
document.getElementById("loginBox").style.display="block";
document.getElementById("dashboardContainer").style.display="none";
document.getElementById("profileSection").style.display="none";
document.getElementById("alertEmailVerify").style.display="none";
}
});
</script>

</body>
</html>
